- commit = @repository.commit(branch.target)
%li(class="js-branch-#{branch.name}")
  %h4
    = link_to project_tree_path(@project, branch.name) do
      %strong= truncate(branch.name, length: 60)
      - if branch.name == @repository.root_ref
        %span.label.label-info default
      - if @project.protected_branch? branch.name
        %span.label.label-success
          %i.icon-lock
          protected

      / Declarando a vari√°vel
      - resultado_testes = @repository.resultado_testes(branch.name)

      - if not resultado_testes.nil?
        - if resultado_testes.ultimo_commit[0..10] == commit.short_id && resultado_testes.resultado == 1
          %span.label.label-success 
            %i.icon-thumbs-up
            Testes
        - elsif resultado_testes.ultimo_commit[0..10] == commit.short_id && resultado_testes.resultado == 2
          %span.label.label-danger 
            %i.icon-thumbs-down
            Testes
        - else
          %span.label.label-inverse
            %i.icon-thumbs-down
            Testes pendentes
      - else
        %span.label.label-inverse
          %i.icon-thumbs-down
          Testes pendentes

    .pull-right
      - if can?(current_user, :download_code, @project)
        = render 'projects/repositories/download_archive', ref: branch.name, btn_class: 'btn-grouped btn-group-small'
      - if branch.name != @repository.root_ref
        = link_to project_compare_index_path(@project, from: @repository.root_ref, to: branch.name), class: 'btn btn-grouped btn-small', method: :post, title: "Compare" do
          %i.icon-copy
          Compare

      - if can_remove_branch?(@project, branch.name)
        = link_to project_branch_path(@project, branch.name), class: 'btn btn-grouped btn-small btn-remove remove-row', method: :delete, data: { confirm: 'Removed branch cannot be restored. Are you sure?'}, remote: true do
          %i.icon-trash

  - if commit
    %ul.list-unstyled
      = render 'projects/commits/inline_commit', commit: commit, project: @project
  - else
    %p
      Cant find HEAD commit for this branch
